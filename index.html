<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>VALORYS — Du jeu aux compétences</title>
    <meta name="description" content="Valorys traduit vos performances de jeu en valeur réelle. Découvrez ce que votre rang dit de vos compétences." />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@600;700&display=swap" rel="stylesheet" />

    <!-- Styles -->
    <link rel="stylesheet" href="style.css" />
    <meta name="theme-color" content="#0B0D17" />
  </head>

  <body>
    <!-- ===== HEADER ===== -->
    <header class="site-header">
      <a href="/" class="brand-logo" aria-label="Accueil Valorys">
        <svg class="valorys-icon" width="28" height="28" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M15 20 L50 80 L85 20" stroke="url(#grad1)" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
          <defs>
            <linearGradient id="grad1" x1="15" y1="20" x2="85" y2="80" gradientUnits="userSpaceOnUse">
              <stop stop-color="#6546E0"/><stop offset="0.6" stop-color="#4A61FF"/><stop offset="1" stop-color="#EACD5C"/>
            </linearGradient>
          </defs>
        </svg>
      </a>
    </header>

    <!-- ===== HERO ===== -->
    <main class="hero">
      <h1 class="brand-wordmark"><span class="valorys-glow">VALORYS</span></h1>
      <p class="hero-subtitle">Du jeu aux compétences.</p>

      <!-- Bande de jeux (défilement continu) -->
      <section class="games-strip" aria-label="Jeux analysés par Valorys">
        <div class="games-track">
          <img src="https://cdn.simpleicons.org/leagueoflegends/E8E9F0" alt="League of Legends" />
          <img src="https://cdn.simpleicons.org/valorant/E8E9F0" alt="Valorant" />
          <img src="https://cdn.simpleicons.org/counterstrike/E8E9F0" alt="Counter-Strike 2" />
          <img src="https://cdn.simpleicons.org/overwatch/E8E9F0" alt="Overwatch 2" />
          <img src="https://cdn.simpleicons.org/apexlegends/E8E9F0" alt="Apex Legends" />
          <img src="https://cdn.simpleicons.org/rocketdotai/E8E9F0" alt="Rocket League" />

          <!-- duplication pour loop fluide -->
          <img src="https://cdn.simpleicons.org/leagueoflegends/E8E9F0" alt="League of Legends" />
          <img src="https://cdn.simpleicons.org/valorant/E8E9F0" alt="Valorant" />
          <img src="https://cdn.simpleicons.org/counterstrike/E8E9F0" alt="Counter-Strike 2" />
          <img src="https://cdn.simpleicons.org/overwatch/E8E9F0" alt="Overwatch 2" />
          <img src="https://cdn.simpleicons.org/apexlegends/E8E9F0" alt="Apex Legends" />
          <img src="https://cdn.simpleicons.org/rocketdotai/E8E9F0" alt="Rocket League" />
        </div>
      </section>

      <!-- Module interactif -->
      <div class="hero-input" id="inputBox">
        <input
          type="text"
          id="rankInput"
          placeholder="Ex : Gold IV – LoL / Ascendant – Valorant / Master – Clash Royale"
          autocomplete="off"
        />
        <button id="analyzeButton">Analyser ma valeur</button>
      </div>

      <!-- Résultat + mini visualisation -->
      <div class="hero-result" id="resultContainer" style="display:none;">
        <h3 id="resultTitle"></h3>
        <p id="resultText"></p>

        <!-- (1) Mini visualisation de valeur -->
        <div class="value-meter" aria-label="Indice de valeur">
          <div class="value-meter__fill" id="valueFill"></div>
          <div class="value-meter__ticks">
            <span>Débutant</span><span>Intermédiaire</span><span>Élite</span><span>Légendaire</span>
          </div>
        </div>

        <button id="compareButton" class="ghost-btn">Comparer à d’autres jeux</button>
      </div>
    </main>

    <!-- ===== (2) Section Comment ça marche ===== -->
    <section class="howitworks" id="howitworks" aria-label="Comment ça marche">
      <div class="howitworks__inner">
        <h2 class="howitworks__title reveal-init">Comment ça marche</h2>
        <div class="steps">
          <article class="step-card reveal-init">
            <div class="step-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none"><path d="M4 6h16M4 12h10M4 18h7" stroke="#E8E9F0" stroke-width="2" stroke-linecap="round"/></svg>
            </div>
            <h3>1. Entre ton rang</h3>
            <p>Ex. <em>Gold IV – LoL</em> ou <em>Ascendant – Valorant</em>. Pas besoin de compte.</p>
          </article>

          <article class="step-card reveal-init">
            <div class="step-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none"><path d="M12 3v18M3 12h18" stroke="#E8E9F0" stroke-width="2" stroke-linecap="round"/></svg>
            </div>
            <h3>2. Conversion intelligente</h3>
            <p>Nous estimons la rareté de ton niveau et la comparons entre jeux.</p>
          </article>

          <article class="step-card reveal-init">
            <div class="step-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none"><path d="M5 13l4 4L19 7" stroke="#E8E9F0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </div>
            <h3>3. Ta valeur claire</h3>
            <p>Top %, difficulté, et compétence dominante. Compréhensible en un coup d’œil.</p>
          </article>
        </div>
      </div>
    </section>

    <!-- ===== (4) FOOTER premium ===== -->
    <footer class="site-footer">
      <div class="footer-inner">
        <a href="#" class="footer-logo" aria-label="Valorys">
          <svg class="footer-icon" width="26" height="26" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15 20 L50 80 L85 20" stroke="url(#grad2)" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
            <defs>
              <linearGradient id="grad2" x1="15" y1="20" x2="85" y2="80" gradientUnits="userSpaceOnUse">
                <stop stop-color="#6546E0"/><stop offset="0.6" stop-color="#4A61FF"/><stop offset="1" stop-color="#EACD5C"/>
              </linearGradient>
            </defs>
          </svg>
          <span>VALORYS</span>
        </a>
        <nav class="footer-nav">
          <a href="#howitworks">Comment ça marche</a>
          <a href="mailto:hello@valorys.app">Contact</a>
          <a href="#">Mentions</a>
          <a href="#">Discord</a>
        </nav>
        <small>© <span id="year"></span> Valorys</small>
      </div>
    </footer>

    <!-- ===== SCRIPT ===== -->
    <script>
      /* ==========
        VALORYS — Analyse de rang (v1 + viz & micro-anim)
      ========== */
      const $ = (sel) => document.querySelector(sel);

      const resultContainer = $("#resultContainer");
      const resultTitle = $("#resultTitle");
      const resultText = $("#resultText");
      const analyzeButton = $("#analyzeButton");
      const rankInput = $("#rankInput");
      const compareButton = $("#compareButton");
      const valueFill = $("#valueFill");
      const inputBox = $("#inputBox");

      const norm = (s) => (s || "").toString().trim().toLowerCase();
      const divisionAdjust = { iv: +6, iii: +4, ii: +2, i: 0 };

      function difficultyLabel(p) {
        if (p <= 1) return "Légendaire";
        if (p <= 5) return "Élite";
        if (p <= 10) return "Très élevée";
        if (p <= 25) return "Élevée";
        if (p <= 50) return "Intermédiaire";
        return "Débutant";
      }

      function dominantSkill(t) {
        if (["challenger","radiant","ultimate champion"].includes(t)) return "Leadership & sang-froid";
        if (["grandmaster","immortal","royal champion"].includes(t)) return "Décision sous pression";
        if (["master","champion"].includes(t)) return "Apprentissage rapide";
        if (["diamond","ascendant","grand champion"].includes(t)) return "Vision stratégique";
        if (["emerald","platinum","master (cr)"].includes(t)) return "Constance";
        if (["gold","diamond (cr)","platinum (cr)","challenger (cr)"].includes(t)) return "Gestion des risques";
        return "Progression & résilience";
      }

      const LOL_TIERS = { iron:85, bronze:70, silver:55, gold:40, platinum:25, emerald:15, diamond:8, master:3.5, grandmaster:1.5, challenger:0.1 };
      const VAL_TIERS = { iron:85, bronze:70, silver:55, gold:40, platinum:25, diamond:15, ascendant:8, immortal:2.5, radiant:0.1 };
      const CR_TIERS  = { challenger:60, "master (cr)":40, champion:20, "grand champion":10, "royal champion":4, "ultimate champion":0.5 };

      function detectGame(raw, tierKey) {
        const s = norm(raw);
        if (/(valorant|val\b)/.test(s)) return "valorant";
        if (/(clash|clash royale|cr\b)/.test(s)) return "clash_royale";
        if (/(lol|league of legends|league\b)/.test(s)) return "lol";
        if (["emerald","grandmaster","challenger","iron"].includes(tierKey)) return "lol";
        if (["ascendant","immortal","radiant"].includes(tierKey)) return "valorant";
        if (["ultimate champion","royal champion","grand champion","champion"].includes(tierKey)) return "clash_royale";
        return "valorant";
      }

      function parseRank(raw) {
        const s = norm(raw).replace(/—|–/g, "-");
        const [left, right] = s.split("-").map(x => (x || "").trim());
        const candidate = left || s;

        const tierRegexes = [
          { re: /(radiant|immortal|ascendant|diamond|platinum|gold|silver|bronze|iron)\s*(iv|iii|ii|i)?/ }, // Valorant
          { re: /(challenger|grandmaster|master|diamond|emerald|platinum|gold|silver|bronze|iron)\s*(iv|iii|ii|i)?/ }, // LoL
          { re: /(ultimate champion|royal champion|grand champion|champion|master|challenger)/ } // Clash Royale
        ];

        for (const { re } of tierRegexes) {
          const m = candidate.match(re);
          if (m) {
            const tier = m[1];
            const div = m[2] || null;
            const resolvedGame = detectGame(right || s, norm(tier));
            return { game: resolvedGame, tier, tierKey: norm(tier), division: div ? norm(div) : null };
          }
        }
        return null;
      }

      function computePercentile(meta) {
        const { game, tierKey, division } = meta;
        let base;
        if (game === "lol") base = LOL_TIERS[tierKey];
        else if (game === "valorant") base = VAL_TIERS[tierKey];
        else if (game === "clash_royale") base = CR_TIERS[tierKey === "master" ? "master (cr)" : tierKey];
        if (typeof base !== "number") return null;

        let adj = base;
        if (division && divisionAdjust[division] != null) adj = Math.min(99, base + divisionAdjust[division]);
        if (adj < 0.05) adj = 0.05;
        return Number(adj.toFixed(adj < 1 ? 2 : adj < 10 ? 1 : 0));
      }

      function gameLabel(id) {
        if (id === "lol") return "League of Legends";
        if (id === "valorant") return "Valorant";
        if (id === "clash_royale") return "Clash Royale";
        return "Jeu";
      }

      function titleCaseRank(tier, division) {
        const up = (w) => w.charAt(0).toUpperCase() + w.slice(1);
        const t = tier.split(" ").map(up).join(" ");
        return division ? `${t} ${division.toUpperCase()}` : t;
      }

      // Styles dynamiques de la carte résultat
      function resultStyle(p) {
        if (p <= 5)  return { border:"rgba(234,205,92,.45)", bg:"linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03))", shadow:"0 16px 46px rgba(234,205,92,.28)" };
        if (p <= 15) return { border:"rgba(101,70,224,.45)", bg:"linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03))", shadow:"0 14px 44px rgba(101,70,224,.22)" };
        return           { border:"rgba(101,70,224,.28)", bg:"linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02))", shadow:"0 12px 36px rgba(0,0,0,.45)" };
      }

      // (1) Micro-animation "calcul"
      function setCalculating(on) {
        inputBox.classList.toggle("loading", !!on);
        analyzeButton.disabled = !!on;
      }

      // Rendu du résultat + mise à jour de la mini-barre
      function renderResult(meta, p) {
        const g = gameLabel(meta.game);
        const rank = titleCaseRank(meta.tierKey.replace(" (cr)", "") || meta.tier, meta.division);
        const diff = difficultyLabel(p);
        const skill = dominantSkill(meta.tierKey);

        resultTitle.textContent = `Ton rang ${rank} — ${g}`;
        resultText.textContent  = `≈ Top ${p}% des joueurs · Difficulté : ${diff} · Compétence dominante : ${skill}.`;

        const s = resultStyle(p);
        resultContainer.style.display = "block";
        resultContainer.classList.add("show");
        resultContainer.style.borderColor = s.border;
        resultContainer.style.background = s.bg;
        resultContainer.style.boxShadow = `${s.shadow}, 0 0 0 1px rgba(101,70,224,.12) inset`;

        // Valeur "inversée" (plus le % est petit, plus la valeur est grande)
        const score = Math.max(0, Math.min(100, 100 - p)); // 0..100
        valueFill.style.width = score + "%";
        valueFill.setAttribute("aria-valuenow", String(score));
      }

      function renderError(msg) {
        resultTitle.textContent = "Impossible d’analyser ce rang";
        resultText.textContent  = msg || "Vérifie le format : ex. “Gold IV – LoL”, “Ascendant – Valorant”.";
        resultContainer.style.display = "block";
        resultContainer.classList.add("show");
        valueFill.style.width = "0%";
      }

      function analyze() {
        const raw = rankInput.value.trim();
        if (!raw) return;
        setCalculating(true);
        resultContainer.style.display = "block";
        resultContainer.classList.add("show");
        resultTitle.textContent = "Analyse en cours…";
        resultText.textContent  = "Évaluation du rang et comparaison…";

        // Laisse respirer la micro-anim
        setTimeout(() => {
          const meta = parseRank(raw);
          if (!meta) { setCalculating(false); return renderError(); }
          const pct = computePercentile(meta);
          if (pct == null) { setCalculating(false); return renderError("Rang non reconnu pour ce jeu."); }
          renderResult(meta, pct);
          setCalculating(false);
        }, 420);
      }

      analyzeButton.addEventListener("click", analyze);
      rankInput.addEventListener("keydown", (e) => { if (e.key === "Enter") analyze(); });
      compareButton.addEventListener("click", () => { rankInput.focus(); rankInput.select(); });

      // Footer year
      document.getElementById("year").textContent = new Date().getFullYear();

      // (2) Scroll reveal (How it works)
      const observer = new IntersectionObserver((entries) => {
        entries.forEach((e) => { if (e.isIntersecting) e.target.classList.add("reveal-visible"); });
      }, { threshold: 0.2 });
      document.querySelectorAll(".reveal-init").forEach((el) => observer.observe(el));
    </script>
  </body>
</html>
